function Q(){if(La=M(),ob=Ka(La,xb,15,.5,.5,2,jb.High,0,tb,1,2,12),Na=function(a,b,c){if(null!=a&&0===a?La.launch.attr("disabled","disabled"):La.launch.removeAttr("disabled"),b){var d=(10*b/Math.pow(ob.scale,3)).toFixed(1);La.measure.find(".actual-density span").html(d)}if(c){var e=La.launch.data("type"),f=La.launch.html();La.launch.data("type",f),La.launch.html(e)}},BABYLON.Engine.isSupported()){var b=jQuery(N.canvas)[0],c=new BABYLON.Engine(b,!0),a=Sa(c);Pa=jQuery(N.sceneBlocker),jQuery(N.sceneScale).find("input").val(""+ob.scale),jQuery(N.wavePower).find("input").val(""+ob.wavePower),jQuery(N.pinMaxLength).find("input").val(""+ob.pinMaxLength),jQuery(N.blastRadius).find("input").val(""+ob.blastRadius),jQuery(N.blastPower).find("input").val(""+ob.blastPower),jQuery(N.distressDistance).find("input").val(""+ob.distressDistance),jQuery(N.transportDistance).find("input").val(""+ob.transportDistance),jQuery(N.patternLimit).find("input").val(""+ob.patternLimit).attr("max",""+ob.wavePower),jQuery(N.wordLength).find("input").val(""+ob.wordLength),jQuery(N.vocabLength).find("input").val(""+ob.vocabLength),gb=i(b,a,ob.scale),jQuery(document).off("wheel,mousewheel").on("wheel,mousewheel",function(){}),hb=j(a),eb=s(a,ob.scale),c.runRenderLoop(function(){a.render()}),L(c,a,ob.scale,b)}}function Sa(b){var a=new BABYLON.Scene(b);return a.clearColor=new BABYLON.Color3(.1,.1,.13),a}function Qa(){Pa.removeClass("hidden")}function L(c,d,h,e){function f(){Qa(),La.processWaveButton.attr("disabled","disabled"),La.keepSelected.prop("checked",!1),fb(ob,La),La.measure.find(".measure-value span").html(ob.scale),a.dispose(),b.dispose(),d.dispose(),eb.dispose(),gb.dispose();var f=Sa(c);c.stopRenderLoop(),j(f),eb=s(f,ob.scale),gb=i(e,f,ob.scale),c.runRenderLoop(function(){f.render()}),L(c,f,ob.scale,e)}setTimeout(function(){Pa.addClass("hidden")},1300),ob=Ka(La,+La.scale.val(),+La.wavePower.val(),+La.pinMaxLength.val(),+La.blastRadius.val(),+La.blastPower.val(),kb(La.resolution),+La.distressDistance.val(),+La.transportDistance.val(),+La.patternLimit.val(),+La.wordLength.val(),+La.vocabLength.val()),nb(ob.resolution,{Low:function(){La.pinMaxLength.removeAttr("disabled"),La.blastRadius.removeAttr("disabled"),La.blastPower.removeAttr("disabled"),La.measure.find(".actual-density").show(),La.setSignalButton.removeClass("shifted"),jQuery(".low-w").show(),jQuery(".high-w").hide()},High:function(){La.pinMaxLength.attr("disabled","disabled"),La.blastRadius.attr("disabled","disabled"),La.blastPower.attr("disabled","disabled"),La.processWaveButton.attr("disabled","disabled"),La.launch.attr("disabled","disabled"),La.measure.find(".actual-density").hide(),fb(ob,La),La.setSignalButton.addClass("shifted"),La.measure.find(".measure-value span").html(ob.scale),jQuery(".low-w").hide(),jQuery(".high-w").show()}});var a=new I(d,h,Aa,ob,Na),b=new J(Aa),g=function(){var b=+La.pinMaxLength.val();b!==ob.pinMaxLength&&(ob.pinMaxLength=+La.pinMaxLength.val(),a.cortex.resetSynapces()),ob.blastRadius=+La.blastRadius.val(),ob.blastPower=+La.blastPower.val()};La.launch.off("click").on("click",function(){var c=La.launch.data("type"),d=La.launch.html();La.launch.data("type",d),La.launch.html(c),c?"PAUSE"===c?nb(ob.resolution,{Low:function(){return b.resume(a)},High:function(){a.wave()}}):"PLAY"===c&&(La.launch.html(c),nb(ob.resolution,{Low:function(){return b.pause(a)},High:function(){return a.wait()}})):(La.launch.html("PAUSE"),nb(ob.resolution,{Low:function(){return b.flow()},High:function(){a.blow()}}))}),La.setDendritsButton.off("click").on("click",function(){ob.scale=+La.scale.val();var a=ob.scale<tb?jb.Low:jb.High;La.launch.data("type",""),ob.resolution!==a&&(ob.resolution=lb(La.resolution)),f()}),La.wavePower.off("blur").on("blur",function(){var a=+La.wavePower.val(),b=+La.patternLimit.val();b>a&&La.patternLimit.val(a).attr("max",a)}),La.setSignalButton.off("click").on("click",function(){var b=+La.wavePower.val(),c=+La.distressDistance.val(),d=+La.transportDistance.val(),e=+La.patternLimit.val(),f=+La.wordLength.val(),h=+La.vocabLength.val();ob.wavePower=b,ob.distressDistance=c,ob.transportDistance=d,ob.patternLimit=e,ob.wordLength=f,ob.vocabLength=h,g(),nb(ob.resolution,{Low:function(){La.processWaveButton.removeAttr("disabled")},High:function(){La.launch.removeAttr("disabled"),La.launch.data("type",""),La.launch.html("PLAY")}}),a.cortex.initSignal(ob.wavePower,ob.distressDistance,ob.transportDistance,ob.patternLimit,ob.wordLength,ob.vocabLength)}),La.processWaveButton.off("click").on("click",function(){g(),a.cortex.dropSpikes(),a.cortex.disposeBlasts(),a.cortex.computeBlasts()}),La.resolution.off("click").on("click",function(b){mb(La.resolution,$(b.target))||(ob.resolution=lb(La.resolution),pb(ob.resolution)?(La.scale.val(ub),a.wait()):La.scale.val(tb),ob.scale=+La.scale.val(),f())}),La.keepSelected.off("change").on("change",function(){a.cortex.keepSelected(La.keepSelected.prop("checked"))}),La.measure.off("mouseenter").on("mouseenter",function(){eb.material.emissiveColor=new BABYLON.Color3(1,1,0)}),La.measure.off("mouseleave").on("mouseleave",function(){eb.material.emissiveColor=new BABYLON.Color3(0,0,0)}),b.tense.eventCallback("onComplete",function(){b.restart(a),b.pause(a),La.launch.html("PLAY"),La.launch.data("type","PAUSE")}),a.expose(b)}function Ka(d,g,c,b,e,f,m,h,i,j,k,l){var a={scale:g,dendritsAmount:0,synapcesAmount:0,wavePower:c,pinMaxLength:b,blastRadius:e,blastPower:f,realSynapcesDistance:b,resolution:m,distressDistance:h,transportDistance:i,patternLimit:j,wordLength:k,vocabLength:l};return fb(a,d),a}function fb(a,c){var d=1e9,e=7e8,f=Math.pow(a.scale,3)/d,g=Math.round(a.scale/a.realSynapcesDistance),b=Math.ceil(e*f);a.dendritsAmount=Math.ceil(b/g),a.synapcesAmount=Math.round(b/a.dendritsAmount),c.actualDendritsAmount.html(""+a.dendritsAmount),c.actualSynapcesAmount.html(""+b)}function ya(){for(var a=new Array,b=0;4>b;b++)xa(a);return a}function xa(a){a.push(Nb[Math.floor(Math.random()*Nb.length)])}function wa(b){var a=Nb[Math.floor(Math.random()*Nb.length)];U(b,a,a)}function va(){for(var a=T(),b=0;6>b;b++)wa(a);return a}function Pb(f,g){for(var a,b,c=T(),d=0;g>d;d++){a=new Array;for(var e=0;f>e;e++)a.push(Nb[Math.floor(Math.random()*Nb.length)]);b=a.join(""),U(c,b,b)}return c}function nb(b,a){switch(b){case jb.High:return a.High();case jb.Low:return a.Low()}}function H(b,k,c,d,e,f,g,h,i,j,a,l,m,n,o,p,q,r,s,t){return{launch:b,slider:k,actualDendritsAmount:c.find("span"),wavePower:d.find("input"),blastRadius:e.find("input"),blastPower:f.find("input"),actualSynapcesAmount:g.find("span"),pinMaxLength:h.find("input"),setDendritsButton:i,setSignalButton:j,processWaveButton:a,keepSelected:l.find("input"),measure:m,scale:n.find("input"),resolution:o.find("label"),distressDistance:p.find("input"),transportDistance:q.find("input"),patternLimit:r.find("input"),wordLength:s.find("input"),vocabLength:t.find("input")}}function M(){var b=jQuery(N.launch),k=jQuery(N.slider),c=jQuery(N.actualDendritsAmount),d=jQuery(N.wavePower),e=jQuery(N.actualSynapcesAmount),f=jQuery(N.pinMaxLength),g=jQuery(N.blastRadius),h=jQuery(N.blastPower),i=jQuery(N.keepSelected),j=jQuery(N.measure),a=jQuery(N.sceneScale),l=jQuery(N.resolution),m=jQuery(N.setDendritsButton),n=jQuery(N.setSignalButton),o=jQuery(N.processWaveButton),p=jQuery(N.distressDistance),q=jQuery(N.transportDistance),r=jQuery(N.patternLimit),s=jQuery(N.wordLength),t=jQuery(N.vocabLength);return H(b,k,c,d,g,h,e,f,m,n,o,i,j,a,l,p,q,r,s,t)}function kb(a){var b=a.filter(".active").hasClass("high");return b?jb.High:jb.Low}function lb(a){var b=a.filter(".active"),c=a.filter(":not(.active)");return b.removeClass("active"),c.addClass("active"),kb(a)}function mb(b,a){return nb(kb(b),{Low:function(){return a.hasClass("low")},High:function(){return a.hasClass("high")}})}function pb(a){return a==jb.Low}function G(a,b){return{one:a,two:b}}function Z(a){return a===Y.Medium}function ia(a){return a===ha.Forward}function b(b){return b===a.Active}function ka(b,c){var a=new BABYLON.StandardMaterial("i",b);return a.emissiveColor=c,a.specularColor=new BABYLON.Color3(1,1,1),a}function ta(b){var a=new BABYLON.StandardMaterial("i",b);return a.diffuseColor=new BABYLON.Color3(0,1,0),a.emissiveColor=new BABYLON.Color3(0,1,0),a.specularColor=new BABYLON.Color3(0,0,0),a.alpha=0,a}function Ea(b){var a=new BABYLON.StandardMaterial("kosh",b);return a.diffuseColor=new BABYLON.Color3(1,1,1),a.emissiveColor=new BABYLON.Color3(.45,.45,.45),a.alpha=.03,a.specularPower=12,a.reflectionFresnelParameters=new BABYLON.FresnelParameters,a.reflectionFresnelParameters.bias=.5,a.emissiveFresnelParameters=new BABYLON.FresnelParameters,a.emissiveFresnelParameters.bias=.7,a.emissiveFresnelParameters.power=2,a.emissiveFresnelParameters.leftColor=BABYLON.Color3.White(),a.emissiveFresnelParameters.rightColor=BABYLON.Color3.Black(),a.opacityFresnelParameters=new BABYLON.FresnelParameters,a.opacityFresnelParameters.leftColor=BABYLON.Color3.White(),a.opacityFresnelParameters.rightColor=BABYLON.Color3.Black(),a}function db(b,a){return b.emissive=Xa(a.r,a.g,a.b),b}function ab(a){return new BABYLON.StandardMaterial("Name-"+d()*d(),a)}function Xa(a,b,c){return{r:a,g:b,b:c}}function $a(a,b,c,d,e){return{emissive:a,specular:b,ambient:c,specularPower:d,alpha:e}}function Wa(b,a,c){b.emissiveColor=new BABYLON.Color3(a.emissive.r,a.emissive.g,a.emissive.b),b.specularColor=new BABYLON.Color3(a.specular.r,a.specular.g,a.specular.b),b.ambientColor=new BABYLON.Color3(a.ambient.r,a.ambient.g,a.ambient.b),b.specularPower=a.specularPower,b.alpha=void 0===c?a.alpha:c}function cb(a,b){a.alpha=b}function Ja(b){var a=new BABYLON.StandardMaterial("kosh",b);return a.diffuseColor=new BABYLON.Color3(.5,0,0),a.emissiveColor=new BABYLON.Color3(.5,.5,.5),a.alpha=.2,a.specularPower=16,a.reflectionFresnelParameters=new BABYLON.FresnelParameters,a.reflectionFresnelParameters.bias=.1,a.emissiveFresnelParameters=new BABYLON.FresnelParameters,a.emissiveFresnelParameters.power=4,a.emissiveFresnelParameters.leftColor=BABYLON.Color3.White(),a.emissiveFresnelParameters.rightColor=BABYLON.Color3.Black(),a.opacityFresnelParameters=new BABYLON.FresnelParameters,a.opacityFresnelParameters.leftColor=BABYLON.Color3.White(),a.opacityFresnelParameters.rightColor=BABYLON.Color3.Black(),a}function ba(b){var a=new BABYLON.StandardMaterial("i",b);return a.alpha=0,a}function ca(b){var a=new BABYLON.StandardMaterial("a",b);return a.emissiveColor=new BABYLON.Color3(1,.5,.5),a}function E(b){for(var c=new Array,a=b.length-1;a>=0;a--)c.push(b[a].clone());return c}function F(b){for(var c=new Array,a=0;a<b.length;a++)c.push(b[a].clone());return c}function ja(c,b){for(var a=0;a<b.length;a++)c.push(b[a])}function Gb(b,c,d){var a=zb(b,c);return a?d>a:!1}function Fb(b,c,d){var a=zb(b,c);return a?a>d:!1}function Bb(a,c,d){var e=sb(a.mesh.curve[0],a.mesh.curve[1]),f=sb(c,a.mesh.curve[0]),b=wb(e,f);return b?d>b:!1}function Kb(a,b,d){var e=sb(a.mesh.curve[0],a.mesh.curve[1]),f=sb(b.mesh.curve[0],b.mesh.curve[1]),g=sb(a.mesh.curve[0],b.mesh.curve[0]),c=vb(e,f,g);return c?d>c:!1}function Jb(a,b,d){var e=sb(a.mesh.curve[0],a.mesh.curve[1]),f=sb(b.mesh.curve[0],b.mesh.curve[1]),g=sb(a.mesh.curve[0],b.mesh.curve[0]),c=vb(e,f,g);return c?c>d:!1}function wb(b,c){var i=0,d=b.x,e=b.y,a=b.z,f=c.x,g=c.y,h=c.z,j=Math.sqrt(Math.pow(e*h-a*g,2)+Math.pow(a*f-d*h,2)+Math.pow(d*g-f*e,2)),k=Math.sqrt(Math.pow(d,2)+Math.pow(e,2)+Math.pow(a,2));return i=j/k}function vb(i,h,g){var m=0,c=i.x,d=i.y,e=i.z,a=h.x,f=h.y,b=h.z,j=g.x,k=g.y,l=g.z,n=j*d*b+e*k*a+c*l*f-a*d*l-c*k*b-j*f*e,o=Math.sqrt(Math.pow(d*b-e*f,2)+Math.pow(e*a-c*b,2)+Math.pow(c*f-a*d,2));return m=n/o}function zb(a,b){return Math.sqrt(Math.pow(a.x-b.x,2)+Math.pow(a.y-b.y,2)+Math.pow(a.z-b.z,2))}function sb(a,b){return o(b.x-a.x,b.y-a.y,b.z-a.z)}function T(){return{}}function V(a,b){return a[S(b)]}function W(a,b){return void 0!==a[S(b)]}function Lb(a,b){return void 0!==a[b]}function U(a,b,c){a[S(b)]=c}function Mb(a,b,c){a[b]=c}function X(a,b){a[S(b)]=void 0}function S(a){return a.toString()}function Ba(b){var a=new Array;for(var c in b)a.push(c);return a}function Ca(a){var b=new Array;for(var c in a)b.push(V(a,c));return b}function Da(a,b){Ca(a).forEach(b)}function la(b){var a=0;for(var c in b)a++;return a}function c(){var a=d(),b=d();return(a-b)/Math.abs(a-b)}function d(){return Math.random()}function Ia(){return d()*c()}function Ga(a){var b=Math.random(),c=1-a,d=a;return d>=b&&c>=b?b:Ga(a)}function Ha(a){return Ga(a)*c()}function da(){var a=d(),b=d();return a*b*1e7}function Fa(){var a=d();return.1>a?1-a:a}function ib(a){return-1*a}function i(c,d,b){var a=new BABYLON.ArcRotateCamera("Camera",Math.PI/12,0,b,new BABYLON.Vector3(0,0,0),d);a.setPosition(new BABYLON.Vector3(0,b/1.5,-3*b));var e=Math.PI/2*.99;return a.lowerBetaLimit=1/b,a.upperBetaLimit=2*e,a.lowerRadiusLimit=b/2,a.alpha=5.5,a.attachControl(c,!1),a}function j(b){var c=new BABYLON.HemisphericLight("light1",new BABYLON.Vector3(0,1,0),b);c.intensity=.3,c.groundColor=new BABYLON.Color3(.17,.57,1);var a=new BABYLON.PointLight("Omni",new BABYLON.Vector3(0,50,50),b);return a.intensity=0,a.diffuse=new BABYLON.Color3(0,.1,.1),a.specular=new BABYLON.Color3(0,0,.1),a}function s(c,d){var b=BABYLON.Mesh.CreateBox("borders",d,c);b.position=new BABYLON.Vector3(0,0,0);var a=new BABYLON.StandardMaterial("wire",c);return a.ambientColor=new BABYLON.Color3(1,1,1),a.emissiveColor=new BABYLON.Color3(0,0,0),a.wireframe=!0,a.alpha=.8,b.material=a,b}function z(){var a=function(){return c()*Math.PI/Math.random()};return new BABYLON.Vector3(a(),a(),a())}function l(b){var a=function(){return b*Math.random()*c()};return new BABYLON.Vector3(a(),a(),a())}function y(d){var a=function(){return Math.random()*c()},b=new BABYLON.Vector3(a(),a(),a());return b.scale(d),b}function f(p,b){for(var n=new Array,e=new Array,f=new Array,g=o(0,0,0),h=b>1?2*p/b:15,a=0;b>=a;a+=1){e.push(g);var j=a%7==0||a%6==0?!0:!1;g=o(g.x+(b>1?d():1)*h*(j?c():1),g.y+(b>1?d():1)*h*(j?c():1),g.z+(b>1?d():1)*h*(j?c():1))}for(var l=new BABYLON.Quaternion(d()*c(),d()*c(),d()*c()).normalize(),x=BABYLON.Matrix.Compose(new BABYLON.Vector3(1,1,1),l,new BABYLON.Vector3(0,0,0)),a=0;a<e.length;a+=1){var m=BABYLON.Vector3.TransformCoordinates(e[a].clone(),x);f.push(m)}if(f.length){for(var i=f[f.length-1],q=i.x,r=i.y,s=i.z,k=p/(b>1?2.2:1.8),u=ib(q/2)+d()*c()*k,v=ib(r/2)+d()*c()*k,w=ib(s/2)+d()*c()*k,t=BABYLON.Matrix.Compose(new BABYLON.Vector3(1,1,1),l,new BABYLON.Vector3(u,v,w)),a=0;a<e.length;a+=1){var m=BABYLON.Vector3.TransformCoordinates(e[a].clone(),t);n.push(m)}return n}return f}function o(a,b,c){return new BABYLON.Vector3(a,b,c)}function Db(a,b){return new BABYLON.Vector3(b.x-a.x,b.y-a.y,b.z-a.z)}function R(b,c){var a=b.add(c.negate());return 0===a.x&&0===a.y&&0===a.z}function yb(a,b){var c=(a.x+b.x)/2,d=(a.y+b.y)/2,e=(a.z+b.z)/2;return o(c,d,e)}document.addEventListener("DOMContentLoaded",Q,!1);var Aa=7,ob,La,Na,Pa,eb,gb,hb,p=function(){function a(a,b,c,d){this.synapces=a,this.type=b,this.scene=c,this.cortexState=d,this.isHighlighted=!1,this.alpha=1,this.isLegatee=!1;var e=pb(this.cortexState.resolution)?2*(this.cortexState.synapcesAmount+1):1;this.curve=f(this.cortexState.scale,e),this.center=yb(this.curve[0],this.curve[this.curve.length-1]),this.draw(),this.setMaterial()}return a.prototype.draw=function(){this.cortexState.scale;this.mesh=BABYLON.Mesh.CreateTube("t",this.curve,this.cortexState.scale/400,60,null,0,this.scene,!1,BABYLON.Mesh.FRONTSIDE),this.mesh.material=ab(this.scene),this.deactivate(),pb(this.cortexState.resolution)&&this.registerActions()},a.prototype.setSynapces=function(a){this.synapces=a},a.prototype.registerActions=function(){this.mesh.actionManager&&this.mesh.actionManager.dispose(),this.mesh.actionManager=new BABYLON.ActionManager(this.scene);var a=this;this.mesh.actionManager.registerAction(new BABYLON.ExecuteCodeAction(BABYLON.ActionManager.OnPointerOverTrigger,function(){a.isHighlighted||a.highlightNeuron(!0)})),this.mesh.actionManager.registerAction(new BABYLON.ExecuteCodeAction(BABYLON.ActionManager.OnPointerOutTrigger,function(){a.isHighlighted||a.highlightNeuron(!1)})),this.mesh.actionManager.registerAction(new BABYLON.ExecuteCodeAction(BABYLON.ActionManager.OnLeftPickTrigger,function(){a.highlightNeuron()}))},a.prototype.select=function(){this.isHighlighted=void 0,this.highlightNeuron()},a.prototype.deselect=function(){this.isHighlighted=!1,this.highlightNeuron(!1)},a.prototype.highlightNeuron=function(c){var a=Z(this.type)?Za:Ya,b=this.alpha;(!this.isHighlighted&&c===!0||void 0===c)&&(a=this.isLegatee?_a:bb,b=1),void 0===c&&(this.isHighlighted=!this.isHighlighted),Wa(this.mesh.material,a,b),pb(this.cortexState.resolution)&&this.synapces&&this.synapces.forEach(function(c){Wa(c.mesh.mesh.material,a,b),Wa(c.mesh.synapceLegMesh.material,a,b)})},a.prototype.setAlpha=function(a){this.alpha=a,cb(this.mesh.material,a),pb(this.cortexState.resolution)&&this.synapces&&this.synapces.forEach(function(b){cb(b.mesh.mesh.material,Math.floor(a)),cb(b.mesh.synapceLegMesh.material,Math.floor(a)),b.codeMesh&&cb(b.codeMesh.mesh.material,Math.floor(a))})},a.prototype.setMaterial=function(){Z(this.type)?Wa(this.mesh.material,Za):Wa(this.mesh.material,Ya)},a.prototype.setLegatee=function(a){this.isLegatee=a},a.prototype.resetMaterials=function(a){this.type=a,this.isHighlighted=void 0,this.deactivate()},a.prototype.activate=function(){Wa(this.mesh.material,_a)},a.prototype.deactivate=function(){this.setMaterial()},a.prototype.dispose=function(){this.mesh.actionManager&&(this.mesh.actionManager.dispose(),this.mesh.actionManager=null),this.scene.removeMesh(this.mesh),this.mesh.dispose(),this.mesh=null,this.curve=null,this.synapces=null,this.type=null,this.scene=null,this.cortexState=null},a}(),q=function(){function a(a,b,c,d){var e=this;this.scene=a,this.scale=b,this.spike=c,this.direction=d,this.curve=new Array,_.each(this.spike.neuron.mesh.curve,function(a){e.curve.push(a.clone())}),this.constructMesh(),this.chargeTense()}return a.prototype.setPositionInCurve=function(){var a=this;this.numberPosition=ia(this.direction)?0:this.curve.length-1,void 0!==this.position&&_.each(this.curve,function(b,c){R(b,a.position)&&(a.numberPosition=c)})},a.prototype.reset=function(){this.resetPosition()},a.prototype.resetPosition=function(){this.position=void 0,this.setPositionInCurve(),this.position=this.curve[this.numberPosition].clone(),this.setPosition(this.position)},a.prototype.setPosition=function(a){this.position=a.clone(),this.setPositionInCurve(),this.positionShoulders()},a.prototype.constructMesh=function(){this.mesh=BABYLON.Mesh.CreateSphere("s",8,this.scale/45,this.scene,!1),this.mesh.material=ab(this.scene),this.deactivate()},a.prototype.positionShoulders=function(){this.mesh.position=this.position.clone()},a.prototype.activate=function(){Wa(this.mesh.material,_a),cb(this.mesh.material,1)},a.prototype.deactivate=function(){this.resetPosition(),cb(this.mesh.material,0)},a.prototype.setMaterial=function(){Wa(this.mesh.material,Za)},a.prototype.chargeTense=function(){var a=this,b=this.spike.tense,d=this.spike.neuron.cortex.lifetime,e=ia(this.direction)?F(this.curve.slice(this.numberPosition,this.curve.length)):E(this.curve.slice(0,this.numberPosition)),c={x:this.position.x,y:this.position.y,z:this.position.z};b.eventCallback("onStart",function(){return a.activate()}),b.eventCallback("onUpdate",function(){a.checkIntersection(),a.moveSpikeTo(c)}),b.eventCallback("onComplete",function(){return a.deactivate()}),b.add(TweenMax.to(c,d,{bezier:e,ease:Linear.easeNone}),0)},a.prototype.checkIntersection=function(){var c=this,a=(this.spike.neuron.synapces,T()),d=_.map(this.spike.neuron.synapces,function(b){var c=b.mesh.basePosition;return U(a,c,b),c}),b=T();_.each(d,function(d){if(!W(b,d)&&(U(b,d,d),c.mesh.intersectsPoint(d))){var e=V(a,d);e.activateUntil(700)}})},a.prototype.moveSpikeTo=function(a){this.mesh.position.x=a.x,this.mesh.position.y=a.y,this.mesh.position.z=a.z},a.prototype.dispose=function(){this.deactivate(),this.mesh.dispose(),this.mesh=null,this.curve=null,this.position=null,this.scene=null,this.spike=null,this.direction=null},a}(),r=function(){function a(b,c,a,d){this.scene=b,this.scale=c,this.basePosition=a,this.neuron=d,this.position=this.shiftPosition(this.basePosition.clone()),this.draw(a),this.setMaterial()}return a.prototype.shiftPosition=function(i){var e=this.neuron.cortex.cortexState.pinMaxLength,j=this.neuron.cortex.cortexState.synapcesAmount;e/=j/(this.neuron.cortex.cortexState.scale/this.neuron.cortex.cortexState.realSynapcesDistance);var a=e*d(),b=this.neuron.mesh.curve,g=b[0],h=b[b.length-1],f=h.subtract(g).normalize(),c=.49,k=new BABYLON.Quaternion(Ha(c),Ha(c),Ha(c)),l=new BABYLON.Vector3(a,a,a),m=new BABYLON.Vector3(0,0,0),n=BABYLON.Matrix.Compose(l,k,m),o=BABYLON.Vector3.TransformCoordinates(f,n),p=i.add(o);return p},a.prototype.draw=function(a){this.mesh=BABYLON.Mesh.CreateSphere("s",4,this.scale/(Z(this.neuron.type)?50:85),this.scene,!0),this.mesh.position=this.position,this.synapceLegMesh=BABYLON.Mesh.CreateTube("t",[a,this.position],this.scale/470,10,null,0,this.scene,!0,BABYLON.Mesh.FRONTSIDE),this.mesh.material=ab(this.scene),this.synapceLegMesh.material=ab(this.scene),this.deactivate()},a.prototype.affect=function(a){return this.isCloseEnough(a.one)||this.isCloseEnough(a.two)},a.prototype.isCloseEnough=function(a){var b=this.scale/4,c=Math.abs(this.position.x-a.x),d=Math.abs(this.position.y-a.y),e=Math.abs(this.position.z-a.z);return b>c&&b>d&&b>e},a.prototype.activate=function(){Wa(this.mesh.material,_a),Wa(this.synapceLegMesh.material,_a)},a.prototype.deactivate=function(){this.setMaterial()},a.prototype.setMaterial=function(){Z(this.neuron.type)?(Wa(this.mesh.material,Za),Wa(this.synapceLegMesh.material,Za)):(Wa(this.mesh.material,Ya),Wa(this.synapceLegMesh.material,Ya))},a.prototype.resetMaterials=function(){this.setMaterial()},a.prototype.dispose=function(){this.scene.removeMesh(this.mesh),this.mesh.dispose(),this.mesh=null,this.scene.removeMesh(this.synapceLegMesh),this.synapceLegMesh&&this.synapceLegMesh.dispose&&(this.synapceLegMesh.dispose(),this.synapceLegMesh=null),this.synapceLegMesh=null,this.scene=null,this.basePosition=null,this.position=null,this.neuron=null},a}(),jb;!function(a){a[a.Low=0]="Low",a[a.High=1]="High"}(jb||(jb={}));var Y;!function(a){a[a.Medium=0]="Medium",a[a.Progeny=1]="Progeny"}(Y||(Y={}));var ha;!function(a){a[a.Forward=0]="Forward",a[a.Backeard=1]="Backeard"}(ha||(ha={}));var a;!function(a){a[a.Active=0]="Active",a[a.Silent=1]="Silent"}(a||(a={}));var Za=$a(Xa(.5,.5,.5),Xa(1,1,1),Xa(0,0,1),70,1),Ya=$a(Xa(0,0,.35),Xa(0,0,0),Xa(0,0,.75),70,1),_a=$a(Xa(1,0,0),Xa(1,1,1),Xa(1,0,0),70,1),bb=$a(Xa(1,.9,0),Xa(1,1,1),Xa(1,.9,0),70,1),Tb=$a(Xa(1,.9,0),Xa(1,1,1),Xa(1,.9,0),0,.1),Va={Medium:"medium-neuron",Progeny:"progeny-neuron",Signal:"signal-neuron",Selected:"selected-neuron"},u=function(){function a(b,c,d,a,e){this.scene=b,this.scale=c,this.lifetime=d,this.cortexState=a,this.spaceCallback=e,this.firstLaunch=!0,this.createNeurons(),this.createSpirits(),this.resetNeuronsCodes(),pb(a.resolution)?(this.spaceCallback(null,this.checkSynapcesAmountInBox()),this.preprocessLowBlasts()):this.fillDeltaAchievableMap()}return a.prototype.preprocessLowBlasts=function(){var a=this,b=this.collectMediumSynapces();this.collectProgenySynapces();this.blasts=T(),this.blastsArray=new Array,b.forEach(function(d){var e=_.filter(b,function(a){return d.neuron.id!==a.neuron.id}),c=new P(d,a.cortexState.blastRadius,e,a.scene,a.cortexState.blastPower);c.isExists?a.blastsArray.push(c):c=null})},a.prototype.resetNeuronsCodes=function(){var a=this;_.each(this.neurons,function(b){b.setCodes(a.cortexState.wordLength,a.cortexState.vocabLength)})},a.prototype.fillDeltaAchievableMap=function(){var a=this;this.firstLineDeltaAchievableNeuronsMap=T(),this.secondLineDeltaAchievableNeuronsMap=T(),this.distressDeltaAchievableNeuronsIdsMap=T(),this.secondLineDeltaAchievableNeuronsIdsMap=T(),_.each(this.neurons,function(b){var c=new Array;_.each(a.neurons,function(d){Gb(b.mesh.center,d.mesh.center,a.cortexState.transportDistance)&&b.isForwardCompatibleByCodes(b)&&c.push(d)}),U(a.firstLineDeltaAchievableNeuronsMap,b.id,c)}),_.each(this.neurons,function(b){var e=V(a.firstLineDeltaAchievableNeuronsMap,b.id),c=new Array,d=T();_.each(e,function(e){Kb(b,e,a.cortexState.transportDistance)&&(c.push(e),U(d,e.id,e.id))}),U(a.secondLineDeltaAchievableNeuronsMap,b.id,c),U(a.secondLineDeltaAchievableNeuronsIdsMap,b.id,d)}),_.each(this.neurons,function(b){var c=new Array;_.each(a.neurons,function(d){Gb(b.mesh.center,d.mesh.center,a.cortexState.distressDistance)&&c.push(d.id)}),U(a.distressDeltaAchievableNeuronsIdsMap,b.id,c)})},a.prototype.resolveSignalInheritanse=function(){for(var b=0;b<this.blastsArray.length;b++)for(var f=this.blastsArray[b],c=0;c<this.neurons.length;c++){var e=!1,a=this.neurons[c];if(!Z(a.type)){for(var d=0;d<a.synapces.length&&!(e=f.checkIntersection(a.synapces[d]));d++);if(e){a.mesh.setLegatee(!0),a.mesh.select();break}}}},a.prototype.resolveNextLayer=function(){var a=this;_.each(this.actualSignalNeurons,function(b){var c=V(a.secondLineDeltaAchievableNeuronsMap,b.id),d=V(a.distressDeltaAchievableNeuronsIdsMap,b.id);_.each(c,function(b){var d=V(a.secondLineDeltaAchievableNeuronsIdsMap,b.id),c=0;_.each(a.actualSignalNeurons,function(a){Lb(d,a.stringId)&&(c+=1)}),Lb(a.usedSignalNeuronsIdsMap,b.stringId)||Lb(a.waveFrontNeurons,b.stringId)||Lb(a.distressedNeuronsIdsMap,b.stringId)||b.isDroppedOff||!(c>=a.cortexState.patternLimit)||(b.mesh.setLegatee(!0),b.mesh.select(),Mb(a.waveFrontNeurons,b.stringId,b))}),_.each(d,function(b){U(a.distressedNeuronsIdsMap,b,b)})})},a.prototype.processWaveFromStart=function(){var a=this;this.distressedNeuronsIdsMap=T(),this.timer&&clearInterval(this.timer),this.resolveNextLayer(),this.timer=setInterval(function(){a.processNextLayer()},1e3)},a.prototype.resumeNextLayer=function(){var a=this;this.timer&&clearInterval(this.timer),this.timer=setInterval(function(){a.processNextLayer()},1e3)},a.prototype.processNextLayer=function(){la(this.waveFrontNeurons)>0?(this.prepareNextLayer(),this.resolveNextLayer()):(clearInterval(this.timer),this.spaceCallback(1,null,!0))},a.prototype.freezeLayer=function(){clearInterval(this.timer)},a.prototype.prepareNextLayer=function(){var a=this;_.each(this.actualSignalNeurons,function(a){Wa(a.mesh.mesh.material,Za,.1)}),this.actualSignalNeurons=new Array,_.each(Ca(this.waveFrontNeurons),function(b){b.includeInSignal(),U(a.usedSignalNeuronsIdsMap,b.id,b),a.actualSignalNeurons.push(b)}),this.waveFrontNeurons=T()},a.prototype.collectMediumSynapces=function(){var a=new Array;return this.neurons.forEach(function(b){Z(b.type)&&ja(a,b.synapces)}),a},a.prototype.collectProgenySynapces=function(){var a=new Array;return this.neurons.forEach(function(b){Z(b.type)||ja(a,b.synapces)}),a},a.prototype.checkSynapcesAmountInBox=function(){var b=0,a=function(a){var b=ob.scale/1.25;return b>a&&a>-b};return this.neurons.forEach(function(c){c.synapces.forEach(function(d){var c=d.mesh.position;a(c.x)&&a(c.y)&&a(c.z)&&b++})}),b},a.prototype.createNeurons=function(){this.neurons=new Array;for(var b=0;b<this.cortexState.dendritsAmount;b++)this.neurons.push(new k(this,Y.Progeny));var a=this.cortexState.scale/2,c=new BABYLON.Vector3(a,a,a);this.revealDormantSignalNeurons(c)},a.prototype.createSpirits=function(){this.spiritsMap=T();for(var h,g,e,c=this.cortexState.scale/2-Vb/2,d=Math.floor(this.cortexState.scale/Vb),k=Math.pow(d,3),a=0,b=0,i=0,f=0;k>f;f++){a>=d&&(b+=1,a=0),b>=d&&(i+=1,a=0,b=0),h=a*Vb-c,g=b*Vb-c,e=i*Vb-c,a+=1;var l=new BABYLON.Vector3(h,g,e),j=new Ub(l,this.scene,this.cortexState);U(this.spiritsMap,j.id,j)}},a.prototype.revealDormantSignalNeurons=function(b){var a=this;this.dormantSignalNeurons=new Array,_.each(this.neurons,function(c){Fb(c.mesh.center,b,a.cortexState.distressDistance)&&Gb(c.mesh.center,b,a.cortexState.transportDistance)&&a.dormantSignalNeurons.push(c)})},a.prototype.initSignal=function(c,e,f,g,h,i){this.dropSignal(),this.cortexState.patternLimit=g,this.cortexState.wordLength=h,this.cortexState.vocabLength=i,this.resetNeuronsCodes(),this.actualSignalNeurons=new Array,this.waveFrontNeurons=T(),this.usedSignalNeuronsIdsMap=T(),this.timer&&clearInterval(this.timer),_.each(this.neurons,function(a){a.isDroppedOff&&(a.isDroppedOff=!1)});for(var b=0;c>b&&(this.dormantSignalNeurons&&this.dormantSignalNeurons.length>0);b++){var j=Math.floor((this.dormantSignalNeurons.length-1)*d()),a=this.dormantSignalNeurons[j];a.includeInSignal(),U(this.usedSignalNeuronsIdsMap,a.id,a),this.actualSignalNeurons.push(a)}pb(ob.resolution)?(this.preprocessLowBlasts(),this.resolveSignalInheritanse(),this.spaceCallback(this.blastsArray.length)):(this.cortexState.distressDistance=e,this.cortexState.transportDistance=f,this.fillDeltaAchievableMap(),this.spaceCallback(1))},a.prototype.resetSynapces=function(){this.neurons.forEach(function(a){a.resetSynapces()})},a.prototype.dropSpikes=function(){this.neurons.forEach(function(a){a.dropToInitialState(a.type)})},a.prototype.dropSignal=function(){this.disposeBlasts(),this.neurons.forEach(function(a){a.dropToInitialState(Y.Progeny)})},a.prototype.computeBlasts=function(){pb(ob.resolution)?(this.preprocessLowBlasts(),this.resolveSignalInheritanse(),this.spaceCallback(this.blastsArray.length)):this.fillDeltaAchievableMap()},a.prototype.chargeTense=function(a){_.each(this.neurons,function(b){a.tense.add(function(){return b.play()},0)})},a.prototype.freezeTense=function(a){_.each(this.neurons,function(b){b.pause(a.tense.progress()*a.duration)})},a.prototype.resumeTense=function(a){_.each(this.neurons,function(a){a.resume()})},a.prototype.restartTense=function(a){_.each(this.neurons,function(a){a.restartTense()})},a.prototype.shiftTense=function(b,a){_.each(this.neurons,function(b){b.progress(a)})},a.prototype.keepSelected=function(a){_.each(this.neurons,function(b){a&&!b.mesh.isHighlighted&&b.hide(),a||b.mesh.isHighlighted||b.show()})},a.prototype.dispose=function(){this.disposeBlasts(),_.each(this.neurons,function(a){a.dispose()}),this.neurons=null,this.scene=null,this.cortexState=null,this.spaceCallback=null},a.prototype.disposeBlasts=function(){if(this.disposeMediators(),this.blastsArray){for(var a=0;a<this.blastsArray.length;a++)this.blastsArray[a].dispose();this.blasts=null,this.blastsArray=null}},a.prototype.disposeMediators=function(){_.each(this.neurons,function(a){a.disposeMediators()})},a}(),m=function(){function a(a){this.synapce=a,this.scene=this.synapce.neuron.cortex.scene,this.texture=new BABYLON.Texture(w,this.scene),this.cloud=new BABYLON.ParticleSystem("cloud",10,this.scene),this.cloud.disposeOnStop=!1;var b=this.synapce.neuron.cortex.cortexState.blastRadius;this.cloud.updateFunction=function(g){for(var d=!1,c=0;c<this.particles.length;c++){var a=this.particles[c],e=new BABYLON.Vector3(this.emitter.position.x,this.emitter.position.y,this.emitter.position.z),f=e.subtract(a.position).length();f>b&&(a.lifeTime=0,d=!0),d||(a.angle+=a.angularSpeed*this._scaledUpdateSpeed,a.direction.scaleToRef(this._scaledUpdateSpeed,this._scaledDirection),a.position.addInPlace(this._scaledDirection),this.gravity.scaleToRef(this._scaledUpdateSpeed,this._scaledGravity),a.direction.addInPlace(this._scaledGravity))}},this.setParticles()}return a.prototype.activate=function(){this.cloud.start()},a.prototype.deactivate=function(){this.cloud.stop()},a.prototype.willBeUsed=function(){var a=this.cloud;a.color1=new BABYLON.Color4(Fa(),Fa(),Fa(),.4),a.color2=a.color1;var b=.5;a.emitRate=550,a.minSize=b,a.maxSize=b},a.prototype.setParticles=function(){var a=this.cloud,b=new BABYLON.Vector3(0,0,0);a.particleTexture=this.texture,a.emitter=this.synapce.mesh.mesh,a.minEmitBox=b,a.maxEmitBox=b.clone();var c=new BABYLON.Color4(.1,.1,.1,.15);a.color1=c,a.color2=c;var d=.4;a.minSize=d,a.maxSize=d;a.minLifeTime=1e13,a.maxLifeTime=1e13,a.emitRate=120,a.blendMode=BABYLON.ParticleSystem.BLENDMODE_ONEONE,a.direction1=new BABYLON.Vector3(1,1,1),
a.direction2=new BABYLON.Vector3(-1,-1,-1),a.minAngularSpeed=Math.PI/100,a.maxAngularSpeed=Math.PI,a.minEmitPower=2,a.maxEmitPower=2,a.updateSpeed=.01},a.prototype.dispose=function(){this.cloud.dispose(),this.scene=null,this.texture=null,this.cloud=null,this.synapce=null},a}(),k=function(){function c(a,b){this.cortex=a,this.type=b,this.id=da(),this.code=va(),this.isDroppedOff=!1,this.mesh=new p(this.synapces,this.type,this.cortex.scene,this.cortex.cortexState),this.toDefaultState(),pb(this.cortex.cortexState.resolution)&&this.createSynapces(),this.stringId=this.id.toString()}return c.prototype.isForwardCompatibleByCodes=function(b){for(var c=!Ba(b.inputVocab).length,d=Ba(this.outputVocab),a=0;a<d.length;a++)if(Lb(b.inputVocab,d[a])){c=!0;break}return c},c.prototype.includeInSignal=function(){this.type=Y.Medium,this.mesh.resetMaterials(this.type),pb(this.cortex.cortexState.resolution)&&this.synapces?this.synapces.forEach(function(a){a.reset()}):this.isDroppedOff=!0},c.prototype.dropToInitialState=function(a){this.type=a,this.mesh.setLegatee(!1),this.mesh.resetMaterials(this.type),pb(this.cortex.cortexState.resolution)&&this.synapces&&this.synapces.forEach(function(a){a.reset()}),this.preventSpikes()},c.prototype.setCodes=function(a,b){this.inputVocab=Pb(a,b),this.outputVocab=Pb(a,b)},c.prototype.allowSpikes=function(){this.createSpike(),this.startWatchForSpike(),this.mesh.select()},c.prototype.preventSpikes=function(){this.disposeSpike()},c.prototype.setProgenyCodeMesh=function(){var b=this.cortex.scene,c=this.cortex.scale,a=this.mesh.curve,d=Ca(this.code).join("");this.codeMesh=new za(b,c,a[Math.floor(a.length/2)],d,!0)},c.prototype.hasCodeMesh=function(){return void 0!==this.codeMesh},c.prototype.getId=function(){return this.id.toString()},c.prototype.play=function(){Z(this.type)&&this.spike&&this.spike.tense.play()},c.prototype.pause=function(a){Z(this.type)&&this.spike&&this.spike.tense.pause(a)},c.prototype.resume=function(){Z(this.type)&&this.spike&&this.spike.tense.resume()},c.prototype.progress=function(a){Z(this.type)&&this.spike&&this.spike.tense.progress(a)},c.prototype.createSpike=function(){var a=this;this.spike=new v(this),this.spike.state.subscribe(function(c){b(c)||a.deactivate()})},c.prototype.restartTense=function(){Z(this.type)&&this.spike&&this.spike.reset()},c.prototype.createSynapces=function(){this.synapces=new Array;for(var b=(this.cortex.cortexState.scale,this.cortex.cortexState.synapcesAmount),c=this.mesh.curve,a=0;b>a;a++){var d=c[2*a+1],e=new x(this,d.clone());this.synapces.push(e)}this.mesh.setSynapces(this.synapces)},c.prototype.resetSynapces=function(){this.disposeSynapces(),this.createSynapces()},c.prototype.hide=function(){this.mesh.setAlpha(.07),this.spike&&this.spike.setAlpha(.07)},c.prototype.show=function(){this.mesh.setAlpha(1),this.spike&&this.spike.setAlpha(1)},c.prototype.startWatchForSpike=function(){var a=this;this.spike.moved.subscribe(function(b){_.chain(a.synapces).filter(function(a){return!a.isActive()}).each(function(a){a.mesh.affect(b)&&a.activate()})})},c.prototype.dispose=function(){this.disposeSpike(),this.disposeSynapces(),this.disposeMesh(),this.disposeCodeMesh(),this.state=null,this.cortex=null,this.type=null},c.prototype.disposeSpike=function(){this.spike&&(this.spike.dispose(),this.spike=null)},c.prototype.disposeCodeMesh=function(){this.codeMesh&&this.codeMesh.dispose&&(this.codeMesh.dispose(),this.codeMesh=null)},c.prototype.disposeMesh=function(){this.mesh.dispose(),this.mesh=null},c.prototype.disposeSynapces=function(){_.each(this.synapces,function(a){a.dispose()}),this.synapces=null},c.prototype.activate=function(){this.state(a.Active)},c.prototype.deactivate=function(){this.state(a.Silent)},c.prototype.serveState=function(a){b(a)?this.spike.activate():this.spike.deactivate()},c.prototype.toDefaultState=function(){var b=this;this.state=ko.observable(a.Silent),this.state.subscribe(function(a){return b.serveState(a)})},c.prototype.getMesh=function(){return this.mesh.mesh},c.prototype.watchState=function(a){this.state.subscribe(a)},c.prototype.disposeMediators=function(){_.each(this.synapces,function(a){a.resetMediator()})},c}(),v=function(){function b(a){this.neuron=a,this.speed=1;var b=(this.neuron.getMesh(),this.neuron.cortex.scene),c=this.neuron.cortex.scale;this.chargeTense(),this.mesh=new q(b,c,this,ha.Forward),this.toDefaultState(),this.deactivate(),this.moved=ko.observable(G(new BABYLON.Vector3(0,0,0),new BABYLON.Vector3(0,0,0)))}return b.prototype.activate=function(){this.state(a.Active)},b.prototype.deactivate=function(){this.state(a.Silent)},b.prototype.setAlpha=function(a){cb(this.mesh.mesh.material,a)},b.prototype.reportMovement=function(a){this.moved(a)},b.prototype.dispose=function(){this.mesh.dispose(),this.mesh=null,this.tense.clear(!0),this.tense=null,this.state=null,this.moved=null,this.neuron=null},b.prototype.serveState=function(b){b===a.Active?this.mesh.activate():b===a.Silent&&this.mesh.deactivate()},b.prototype.chargeTense=function(){this.tense=new TimelineMax({repeat:0,paused:!0})},b.prototype.reset=function(){this.tense.restart(),this.mesh.reset()},b.prototype.toDefaultState=function(){var b=this;this.state=ko.observable(a.Silent),this.state.subscribe(function(a){return b.serveState(a)})},b}(),x=function(){function c(a,b){this.neuron=a,this.id=da(),this.code=ya(),this.toDefaultState();var c=this.neuron.cortex.scene,d=this.neuron.cortex.scale;this.mesh=new r(c,d,b,a),this.setMediator(),this.deactivate()}return c.prototype.setMediumCodeMesh=function(a,b){var c=this.neuron.cortex.scene,d=this.neuron.cortex.scale;a>0&&(this.codeMesh=new za(c,d,this.mesh.mesh.position,""+a,b))},c.prototype.reset=function(){this.mesh.resetMaterials(),this.disposeCodeMesh()},c.prototype.allowMediator=function(){this.neuron.allowSpikes(),this.mediator.willBeUsed()},c.prototype.getId=function(){return this.id.toString()},c.prototype.setMediator=function(){this.mediator=new m(this)},c.prototype.activate=function(){this.state(a.Active)},c.prototype.activateUntil=function(b){var c=this;this.state(a.Active),setTimeout(function(){return c.deactivate()},b)},c.prototype.deactivate=function(){this.state&&this.state(a.Silent)},c.prototype.toDefaultState=function(){var b=this;this.state=ko.observable(a.Silent),this.state.subscribe(function(a){return b.serveState(a)})},c.prototype.serveState=function(a){b(a)?(this.mesh.activate(),this.mediator.activate()):(this.mesh.deactivate(),this.mediator.deactivate())},c.prototype.isActive=function(){return b(this.state())},c.prototype.dispose=function(){this.disposeMesh(),this.disposeCodeMesh(),this.disposeMediator(),this.state=null,this.neuron=null},c.prototype.disposeMesh=function(){this.mesh.dispose(),this.mesh=null},c.prototype.disposeMediator=function(){this.mediator.dispose(),this.mediator=null},c.prototype.resetMediator=function(){this.disposeMediator(),this.disposeCodeMesh(),this.setMediator()},c.prototype.disposeCodeMesh=function(){this.codeMesh&&this.codeMesh.dispose&&(this.codeMesh.dispose(),this.codeMesh=null)},c}(),I=function(){function a(a,b,c,d,e){this.scene=a,this.scale=b,this.lifetime=c,this.cortexState=d,this.cortex=new u(a,b,c,d,e)}return a.prototype.expose=function(a){this.time=a,this.cortex.chargeTense(a)},a.prototype.freeze=function(a){this.cortex.freezeTense(a)},a.prototype.resume=function(a){this.cortex.resumeTense(a)},a.prototype.restart=function(a){this.cortex.restartTense(a)},a.prototype.shift=function(a,b){this.cortex.shiftTense(a,b)},a.prototype.blow=function(){this.cortex.processWaveFromStart()},a.prototype.wave=function(){this.cortex.resumeNextLayer()},a.prototype.wait=function(){this.cortex.freezeLayer()},a.prototype.dispose=function(){this.cortex.dispose(),this.cortex=null,this.time=null,this.scene=null,this.cortexState=null},a}(),Ub=function(){function a(a,b,c){this.position=a,this.scene=b,this.cortexState=c,this.id=da(),this.isHighlighted=!1,this.alpha=1,this.stringId=this.id.toString(),this.draw()}return a.prototype.draw=function(){this.cortexState.scale;this.mesh=BABYLON.Mesh.CreateBox("a",Vb,this.scene),this.mesh.material=ab(this.scene),this.mesh.position=this.position,this.deactivate()},a.prototype.highlightCube=function(){var a=Tb,b=.007;this.isHighlighted||(a=bb,b=.02),Wa(this.mesh.material,a,b)},a.prototype.setAlpha=function(a){this.alpha=a,cb(this.mesh.material,a)},a.prototype.activate=function(){this.isHighlighted=!0,this.highlightCube()},a.prototype.deactivate=function(){this.isHighlighted=!1,this.highlightCube()},a.prototype.dispose=function(){this.scene.removeMesh(this.mesh),this.mesh.dispose(),this.mesh=null,this.scene=null,this.cortexState=null},a}(),J=function(){function a(a){this.duration=a,this.tense=new TimelineMax({repeat:0,paused:!0}),this.tense.to(document,a,{},0)}return a.prototype.flow=function(){this.tense.play(0)},a.prototype.resume=function(a){this.tense.resume(),a.resume(this)},a.prototype.pause=function(a){this.tense.pause(),a.freeze(this)},a.prototype.shiftTo=function(b,a){this.tense.progress(a),b.shift(this,a)},a.prototype.restart=function(a){this.tense.restart(),a.restart(this)},a.prototype.dispose=function(){this.tense.clear(!0),this.tense=null},a}(),za=function(){function a(b,d,e,f,a){this.scene=b,this.scale=d,this.position=e,this.text=f,this.isBig=a,this.mesh=BABYLON.Mesh.CreatePlane("outputplane",this.scale/6,this.scene,!1),this.mesh.billboardMode=BABYLON.AbstractMesh.BILLBOARDMODE_ALL,this.mesh.material=new BABYLON.StandardMaterial("outputplane",b),this.mesh.position=this.position,this.mesh.scaling.y=1;var c=new BABYLON.DynamicTexture("dynamic texture",512,b,!0);c.hasAlpha=!0,this.mesh.material.diffuseTexture=c,this.mesh.material.specularColor=new BABYLON.Color3(0,0,0),this.mesh.material.emissiveColor=new BABYLON.Color3(1,1,1),this.mesh.material.backFaceCulling=!1,c.drawText(this.text,null,a?200:160,a?"bold 230px arial":"120px arial",a?"gold":"silver",null)}return a.prototype.setVisibility=function(a){this.mesh.material.alpha=a?1:0},a.prototype.dispose=function(){this.scene.removeMesh(this.mesh),this.mesh.dispose(),this.mesh=null,this.scene=null,this.position=null},a}(),P=function(){function a(c,d,e,f,g){var a=this;this.synapce=c,this.radius=d,this.synapces=e,this.scene=f,this.blastPowerLimit=g,this.isExists=!1,this.synapcesCount=0,this.color=new BABYLON.Color3(Fa(),Fa(),Fa()),this.neuronsMap=T(),this.synapcesMap=T(),this.synapces.forEach(function(b){var d=a.checkIntersection(b),c=b.neuron;d&&(W(a.neuronsMap,c.getId())||U(a.neuronsMap,c.getId(),c),W(a.synapcesMap,b.getId())||U(a.synapcesMap,b.getId(),b),!c.hasCodeMesh())}),this.synapcesCount=la(this.synapcesMap);var b=this.synapcesCount>=this.blastPowerLimit;this.isExists&&b?(this.sphere=BABYLON.Mesh.CreateSphere("s",32,2*this.radius,this.scene,!1),this.sphere.material=Ea(this.scene),this.sphere.position=this.synapce.mesh.position.clone(),this.synapce.allowMediator(),this.synapce.mesh.mesh.material=ka(this.scene,this.color),Da(this.synapcesMap,function(b){ka(a.scene,a.color);b.allowMediator()})):this.isExists=!1,this.synapce.setMediumCodeMesh(this.synapcesCount,b)}return a.prototype.checkIntersection=function(b){var a=this.checkIntersections(b.mesh.position);return a&&(this.isExists||(this.isExists=!0)),a},a.prototype.checkIntersections=function(a){var b=this.synapce.mesh.position,d=Math.pow(b.x-a.x,2),e=Math.pow(b.y-a.y,2),f=Math.pow(b.z-a.z,2),c=Math.sqrt(d+e+f);return c>0&&c<this.radius?!0:!1},a.prototype.getIntersectionsCount=function(){return this.synapcesCount},a.prototype.dispose=function(){this.scene.removeMesh(this.sphere),this.sphere&&this.sphere.dispose&&(this.sphere.dispose(),this.sphere=null),this.neuronsMap=null,this.synapcesMap=null,this.color=null,this.synapce=null,this.synapces=null,this.scene=null},a}(),fa=function(){function a(){}return a}(),tb=15,Eb=7.5,ub=5,xb=50,Nb=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","R","S","T"],Rb=10,Sb=50,Vb=5,C="http://site1.2013321.brim.ru/nru/textures/sun.png",w="http://i166.photobucket.com/albums/u83/j1m68/star.jpg",N={canvas:"#renderCanvas",sceneBlocker:"#sceneBlocker",launch:"#launch",play:"#play",pause:"#pause",restart:"#restart",slider:"#slider",actualDendritsAmount:"#actualDendritsAmount",wavePower:"#wavePower",actualSynapcesAmount:"#actualSynapcesAmount",pinMaxLength:"#pinMaxLength",blastRadius:"#blastRadius",blastPower:"#blastPower",setDendritsButton:"#setDendrits",setSignalButton:"#setSignal",processWaveButton:"#processWave",keepSelected:"#keepSelected",measure:"#measure",sceneScale:"#boxSize",resolution:"#resolution",distressDistance:"#distressDistance",transportDistance:"#transportDistance",patternLimit:"#patternLimit",wordLength:"#wordLength",vocabLength:"#vocabLength"};
//# sourceMappingURL=sourcemap.map